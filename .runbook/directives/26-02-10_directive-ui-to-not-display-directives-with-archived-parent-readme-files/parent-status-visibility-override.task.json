{
  "kind": "directive_task",
  "schema_version": "1.0",
  "meta": {
    "title": "parent status visibility override",
    "status": "archived",
    "priority": "high",
    "owner": "operator",
    "assignee": null,
    "created": "2026-02-10T22:24:23.000Z",
    "updated": "2026-02-11T10:29:39.000Z",
    "result": "completed",
    "summary": "Make directives UI hide sessions with archived parent README unless archived is explicitly requested.",
    "execution_model": "gpt-5.2-codex",
    "thinking_level": "medium",
    "tags": [
      "directives",
      "ui",
      "filtering"
    ],
    "effort": "small",
    "session_priority": "high",
    "bucket": "archived",
    "depends_on": [],
    "blocked_by": [],
    "related": [],
    "id": "cf5f9dca-ffc6-4154-bbc9-9dfe7e0c1aa2"
  },
  "task": {
    "objective": "Update directives UI filtering so parent session status from `README.md` controls visibility for the entire session.",
    "constraints": [
      "Parent `README.md` status is authoritative for session visibility.",
      "If parent status is `archived`, hide the session and its tasks unless archived visibility is explicitly enabled.",
      "Do not change directive file storage or front matter schema.",
      "Keep existing query, tag, and status filtering behavior for non archived sessions.",
      "No em dash characters in generated writing."
    ],
    "allowed_files": [
      {
        "path": "Read: `apps/web/app/directives/**/*`",
        "access": "edit"
      },
      {
        "path": "Read: `apps/web/lib/types/directives/*`",
        "access": "edit"
      },
      {
        "path": "Write: `apps/web/app/directives/composites/DirectivesView.tsx`",
        "access": "edit"
      },
      {
        "path": "Write: `apps/web/app/directives/composites/DirectivesFiltersPanel.tsx` only if needed for archived toggle behavior",
        "access": "edit"
      }
    ],
    "steps": [
      {
        "id": "step_1",
        "instruction": "Review current grouping and filtering in `DirectivesView` and identify where task entries can render without an eligible parent session.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_2",
        "instruction": "Build session level visibility using parent entries first, then include task entries only for sessions whose parent passes visibility rules.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_3",
        "instruction": "Enforce parent override rule: parent `archived` hides entire session unless archived visibility is enabled.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_4",
        "instruction": "Preserve existing status and tag filtering behavior for sessions with non archived parent status.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_5",
        "instruction": "Keep fallback `unknown` values only for truly malformed session folders missing parent README.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_6",
        "instruction": "Verify behavior manually by checking a session with archived parent and non archived tasks, and a session with non archived parent.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_7",
        "instruction": "Record a concise result note with files touched and the behavior change.",
        "files": [],
        "artifact": ""
      }
    ],
    "validation": {
      "commands": [
        "- `npm --prefix apps/web run typecheck`",
        "- `npm --prefix apps/web run lint`"
      ]
    },
    "expected_output": [
      "Sessions with archived parent README are hidden by default in directives UI.",
      "Archived sessions appear only when archived visibility is enabled.",
      "Child tasks do not leak into visible results when parent is archived.",
      "Typecheck and lint pass."
    ],
    "stop_conditions": [
      "Stop if this change requires changing directive storage format.",
      "Stop if parent status cannot be reliably resolved from current parsed directive entries."
    ],
    "notes": []
  }
}

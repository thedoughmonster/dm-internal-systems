{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "DM Actor Model v1",
  "description": "Validates the canonical dm_actor_model_v1 vocabulary and its embedded reference schemas.",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "doc"
  ],
  "properties": {
    "doc": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "id",
        "status",
        "scope",
        "enums",
        "rules",
        "schemas",
        "flows"
      ],
      "properties": {
        "id": {
          "type": "string",
          "const": "dm_actor_model_v1"
        },
        "status": {
          "type": "string",
          "const": "draft"
        },
        "scope": {
          "type": "string",
          "const": "high_level"
        },
        "enums": {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "actor_types",
            "trust_level",
            "signal_role",
            "data_behavior",
            "write_authority",
            "input_control",
            "ingestion_middleman_types"
          ],
          "properties": {
            "actor_types": {
              "type": "object",
              "additionalProperties": false,
              "required": [
                "values",
                "semantics"
              ],
              "properties": {
                "values": {
                  "type": "array",
                  "const": [
                    "feed",
                    "surface",
                    "renderer",
                    "automation",
                    "external_system",
                    "artifact_source"
                  ]
                },
                "semantics": {
                  "type": "object",
                  "additionalProperties": false,
                  "required": [
                    "feed",
                    "surface",
                    "renderer",
                    "automation",
                    "external_system",
                    "artifact_source"
                  ],
                  "properties": {
                    "feed": {
                      "type": "string",
                      "minLength": 1
                    },
                    "surface": {
                      "type": "string",
                      "minLength": 1
                    },
                    "renderer": {
                      "type": "string",
                      "minLength": 1
                    },
                    "automation": {
                      "type": "string",
                      "minLength": 1
                    },
                    "external_system": {
                      "type": "string",
                      "minLength": 1
                    },
                    "artifact_source": {
                      "type": "string",
                      "minLength": 1
                    }
                  }
                }
              }
            },
            "trust_level": {
              "type": "object",
              "additionalProperties": false,
              "required": [
                "values",
                "semantics"
              ],
              "properties": {
                "values": {
                  "type": "array",
                  "const": [
                    "machine_enforced",
                    "schema_validated",
                    "unstructured_artifact"
                  ]
                },
                "semantics": {
                  "type": "object",
                  "additionalProperties": false,
                  "required": [
                    "machine_enforced",
                    "schema_validated",
                    "unstructured_artifact"
                  ],
                  "properties": {
                    "machine_enforced": {
                      "type": "string",
                      "minLength": 1
                    },
                    "schema_validated": {
                      "type": "string",
                      "minLength": 1
                    },
                    "unstructured_artifact": {
                      "type": "string",
                      "minLength": 1
                    }
                  }
                }
              }
            },
            "signal_role": {
              "type": "object",
              "additionalProperties": false,
              "required": [
                "values",
                "semantics"
              ],
              "properties": {
                "values": {
                  "type": "array",
                  "const": [
                    "transmitter",
                    "receiver",
                    "transceiver"
                  ]
                },
                "semantics": {
                  "type": "object",
                  "additionalProperties": false,
                  "required": [
                    "transmitter",
                    "receiver",
                    "transceiver"
                  ],
                  "properties": {
                    "transmitter": {
                      "type": "string",
                      "minLength": 1
                    },
                    "receiver": {
                      "type": "string",
                      "minLength": 1
                    },
                    "transceiver": {
                      "type": "string",
                      "minLength": 1
                    }
                  }
                }
              }
            },
            "data_behavior": {
              "type": "object",
              "additionalProperties": false,
              "required": [
                "values",
                "semantics"
              ],
              "properties": {
                "values": {
                  "type": "array",
                  "const": [
                    "generate",
                    "transform",
                    "render",
                    "store",
                    "alert"
                  ]
                },
                "semantics": {
                  "type": "object",
                  "additionalProperties": false,
                  "required": [
                    "generate",
                    "transform",
                    "render",
                    "store",
                    "alert"
                  ],
                  "properties": {
                    "generate": {
                      "type": "string",
                      "minLength": 1
                    },
                    "transform": {
                      "type": "string",
                      "minLength": 1
                    },
                    "render": {
                      "type": "string",
                      "minLength": 1
                    },
                    "store": {
                      "type": "string",
                      "minLength": 1
                    },
                    "alert": {
                      "type": "string",
                      "minLength": 1
                    }
                  }
                }
              }
            },
            "write_authority": {
              "type": "object",
              "additionalProperties": false,
              "required": [
                "values",
                "semantics"
              ],
              "properties": {
                "values": {
                  "type": "array",
                  "const": [
                    "none",
                    "propose_only",
                    "staging_only",
                    "promote_to_truth",
                    "direct_to_truth"
                  ]
                },
                "semantics": {
                  "type": "object",
                  "additionalProperties": false,
                  "required": [
                    "none",
                    "propose_only",
                    "staging_only",
                    "promote_to_truth",
                    "direct_to_truth"
                  ],
                  "properties": {
                    "none": {
                      "type": "string",
                      "minLength": 1
                    },
                    "propose_only": {
                      "type": "string",
                      "minLength": 1
                    },
                    "staging_only": {
                      "type": "string",
                      "minLength": 1
                    },
                    "promote_to_truth": {
                      "type": "string",
                      "minLength": 1
                    },
                    "direct_to_truth": {
                      "type": "string",
                      "minLength": 1
                    }
                  }
                }
              }
            },
            "input_control": {
              "type": "object",
              "additionalProperties": false,
              "required": [
                "values",
                "semantics"
              ],
              "properties": {
                "values": {
                  "type": "array",
                  "const": [
                    "owned_mutable",
                    "external_immutable"
                  ]
                },
                "semantics": {
                  "type": "object",
                  "additionalProperties": false,
                  "required": [
                    "owned_mutable",
                    "external_immutable"
                  ],
                  "properties": {
                    "owned_mutable": {
                      "type": "string",
                      "minLength": 1
                    },
                    "external_immutable": {
                      "type": "string",
                      "minLength": 1
                    }
                  }
                }
              }
            },
            "ingestion_middleman_types": {
              "type": "object",
              "additionalProperties": false,
              "required": [
                "values",
                "semantics"
              ],
              "properties": {
                "values": {
                  "type": "array",
                  "const": [
                    "none",
                    "parser",
                    "normalizer",
                    "enricher",
                    "validator",
                    "router",
                    "staging_table",
                    "review_gate",
                    "rpc_gate",
                    "batch_job"
                  ]
                },
                "semantics": {
                  "type": "object",
                  "additionalProperties": false,
                  "required": [
                    "none",
                    "parser",
                    "normalizer",
                    "enricher",
                    "validator",
                    "router",
                    "staging_table",
                    "review_gate",
                    "rpc_gate",
                    "batch_job"
                  ],
                  "properties": {
                    "none": {
                      "type": "string",
                      "minLength": 1
                    },
                    "parser": {
                      "type": "string",
                      "minLength": 1
                    },
                    "normalizer": {
                      "type": "string",
                      "minLength": 1
                    },
                    "enricher": {
                      "type": "string",
                      "minLength": 1
                    },
                    "validator": {
                      "type": "string",
                      "minLength": 1
                    },
                    "router": {
                      "type": "string",
                      "minLength": 1
                    },
                    "staging_table": {
                      "type": "string",
                      "minLength": 1
                    },
                    "review_gate": {
                      "type": "string",
                      "minLength": 1
                    },
                    "rpc_gate": {
                      "type": "string",
                      "minLength": 1
                    },
                    "batch_job": {
                      "type": "string",
                      "minLength": 1
                    }
                  }
                }
              }
            }
          }
        },
        "rules": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1
        },
        "schemas": {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "actor"
          ],
          "properties": {
            "actor": {
              "type": "object",
              "additionalProperties": false,
              "required": [
                "description",
                "properties",
                "required"
              ],
              "properties": {
                "description": {
                  "type": "string",
                  "minLength": 1
                },
                "properties": {
                  "type": "object",
                  "additionalProperties": false,
                  "required": [
                    "name",
                    "types",
                    "trust_level",
                    "signal_role",
                    "data_behavior",
                    "write_authority",
                    "input_control",
                    "ingestion_middlemen"
                  ],
                  "properties": {
                    "name": {
                      "type": "object",
                      "additionalProperties": false,
                      "required": [
                        "type",
                        "description"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "const": "string"
                        },
                        "description": {
                          "type": "string",
                          "minLength": 1
                        }
                      }
                    },
                    "types": {
                      "type": "object",
                      "additionalProperties": false,
                      "required": [
                        "type",
                        "items",
                        "description"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "const": "array"
                        },
                        "items": {
                          "type": "object",
                          "additionalProperties": false,
                          "required": [
                            "type",
                            "enum_ref"
                          ],
                          "properties": {
                            "type": {
                              "type": "string",
                              "const": "string"
                            },
                            "enum_ref": {
                              "type": "string",
                              "const": "actor_types"
                            }
                          }
                        },
                        "description": {
                          "type": "string",
                          "minLength": 1
                        }
                      }
                    },
                    "trust_level": {
                      "type": "object",
                      "additionalProperties": false,
                      "required": [
                        "type",
                        "enum_ref",
                        "description"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "const": "string"
                        },
                        "enum_ref": {
                          "type": "string",
                          "const": "trust_level"
                        },
                        "description": {
                          "type": "string",
                          "minLength": 1
                        }
                      }
                    },
                    "signal_role": {
                      "type": "object",
                      "additionalProperties": false,
                      "required": [
                        "type",
                        "enum_ref",
                        "description"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "const": "string"
                        },
                        "enum_ref": {
                          "type": "string",
                          "const": "signal_role"
                        },
                        "description": {
                          "type": "string",
                          "minLength": 1
                        }
                      }
                    },
                    "data_behavior": {
                      "type": "object",
                      "additionalProperties": false,
                      "required": [
                        "type",
                        "items",
                        "description"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "const": "array"
                        },
                        "items": {
                          "type": "object",
                          "additionalProperties": false,
                          "required": [
                            "type",
                            "enum_ref"
                          ],
                          "properties": {
                            "type": {
                              "type": "string",
                              "const": "string"
                            },
                            "enum_ref": {
                              "type": "string",
                              "const": "data_behavior"
                            }
                          }
                        },
                        "description": {
                          "type": "string",
                          "minLength": 1
                        }
                      }
                    },
                    "write_authority": {
                      "type": "object",
                      "additionalProperties": false,
                      "required": [
                        "type",
                        "enum_ref",
                        "description"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "const": "string"
                        },
                        "enum_ref": {
                          "type": "string",
                          "const": "write_authority"
                        },
                        "description": {
                          "type": "string",
                          "minLength": 1
                        }
                      }
                    },
                    "input_control": {
                      "type": "object",
                      "additionalProperties": false,
                      "required": [
                        "type",
                        "enum_ref",
                        "description"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "const": "string"
                        },
                        "enum_ref": {
                          "type": "string",
                          "const": "input_control"
                        },
                        "description": {
                          "type": "string",
                          "minLength": 1
                        }
                      }
                    },
                    "ingestion_middlemen": {
                      "type": "object",
                      "additionalProperties": false,
                      "required": [
                        "type",
                        "items",
                        "description"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "const": "array"
                        },
                        "items": {
                          "type": "object",
                          "additionalProperties": false,
                          "required": [
                            "type",
                            "enum_ref"
                          ],
                          "properties": {
                            "type": {
                              "type": "string",
                              "const": "string"
                            },
                            "enum_ref": {
                              "type": "string",
                              "const": "ingestion_middleman_types"
                            }
                          }
                        },
                        "description": {
                          "type": "string",
                          "minLength": 1
                        }
                      }
                    }
                  }
                },
                "required": {
                  "type": "array",
                  "const": [
                    "name",
                    "types",
                    "trust_level",
                    "signal_role",
                    "data_behavior",
                    "write_authority",
                    "input_control",
                    "ingestion_middlemen"
                  ]
                }
              }
            }
          }
        },
        "flows": {
          "type": "array",
          "items": {
            "type": "object",
            "minProperties": 1
          },
          "default": []
        }
      }
    }
  }
}

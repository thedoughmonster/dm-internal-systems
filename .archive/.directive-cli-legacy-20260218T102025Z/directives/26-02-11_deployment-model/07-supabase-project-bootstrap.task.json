{
  "kind": "directive_task",
  "schema_version": "1.0",
  "meta": {
    "id": "b2e6d870-0705-4c79-b08e-2285da261107",
    "title": "Bootstrap Supabase test and prod projects",
    "status": "todo",
    "priority": "high",
    "session_priority": "medium",
    "owner": "operator",
    "assignee": "executor",
    "bucket": "todo",
    "created": "2026-02-11T08:30:31.000Z",
    "updated": "2026-02-11T08:53:05.000Z",
    "tags": [
      "supabase",
      "infrastructure",
      "environments"
    ],
    "effort": "medium",
    "depends_on": [
      "10f343f7-5f9f-4b4d-9ba2-36afafe01106"
    ],
    "blocked_by": [],
    "related": [],
    "summary": "Create dm_brain_test and dm_brain_prod projects and record non-secret identifiers.",
    "execution_model": "gpt-5.2-codex",
    "thinking_level": "medium"
  },
  "task": {
    "objective": "Set up Supabase infrastructure foundations for test and production environments.",
    "constraints": [
      "Never print or commit secret keys.",
      "Record only non-secret project references.",
      "Test and prod must remain isolated."
    ],
    "allowed_files": [
      {
        "path": "`docs/DEPLOYMENT_INFRA_STATUS.md` (edit)",
        "access": "edit"
      },
      {
        "path": "`docs/ENVIRONMENT_SETUP.md` (create or edit)",
        "access": "edit"
      },
      {
        "path": "`docs/DEPLOYMENT_INFRA_EVIDENCE.md` (edit)",
        "access": "edit"
      }
    ],
    "steps": [
      {
        "id": "step_1",
        "instruction": "In Supabase, verify whether `dm_brain_test` exists; create it if missing.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_2",
        "instruction": "In Supabase, verify whether `dm_brain_prod` exists; create it if missing.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_3",
        "instruction": "Edit `docs/ENVIRONMENT_SETUP.md` and add non-secret project references and dashboard URLs for both projects.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_4",
        "instruction": "Link local Supabase CLI to `dm_brain_test` and record the exact link command in `docs/ENVIRONMENT_SETUP.md`.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_5",
        "instruction": "Capture non-secret evidence of both projects (names and refs only) and record in `docs/DEPLOYMENT_INFRA_EVIDENCE.md`.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_6",
        "instruction": "In `docs/DEPLOYMENT_INFRA_STATUS.md`, mark `TASK_07` as completed and record UTC timestamp.",
        "files": [],
        "artifact": ""
      }
    ],
    "validation": {
      "commands": [
        "test -s docs/ENVIRONMENT_SETUP.md",
        "rg -n \"dm_brain_test|dm_brain_prod|project ref\" docs/ENVIRONMENT_SETUP.md",
        "rg -n \"TASK_07|dm_brain_test|dm_brain_prod\" docs/DEPLOYMENT_INFRA_EVIDENCE.md"
      ]
    },
    "expected_output": [
      "Both Supabase projects exist.",
      "Non-secret project identifiers are documented."
    ],
    "stop_conditions": [
      "Stop and ask operator if Supabase org access is unavailable."
    ],
    "notes": []
  }
}

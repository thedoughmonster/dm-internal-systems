{
  "kind": "directive_task",
  "schema_version": "1.0",
  "meta": {
    "id": "1ed3e58b-2417-41a4-9b37-cefebd9fe9de",
    "title": "Add Storybook consistency preview and decorators",
    "status": "archived",
    "priority": "high",
    "session_priority": "high",
    "owner": "operator",
    "assignee": "executor",
    "bucket": "archived",
    "created": "2026-02-11T15:31:20.000Z",
    "updated": "2026-02-11T16:33:04.000Z",
    "tags": [
      "storybook",
      "decorators",
      "consistency",
      "ui"
    ],
    "effort": "medium",
    "depends_on": [
      "59037f27-22e4-46c1-aef2-3e4e04a88f39"
    ],
    "blocked_by": [],
    "related": [
      "fc7e7c3d-7f67-4f50-9510-134feb649248",
      "1fe2bd05-cf23-4bc6-84b5-e05b8213ee99"
    ],
    "summary": "Configure Storybook preview behavior to mirror shared UI constraints and component contract expectations.",
    "execution_model": "gpt-5.2-codex",
    "thinking_level": "high",
    "collection_id": "ui_component_workbench",
    "collection_title": "UI Component Workbench",
    "collection_order": 2,
    "collection_commit_label": "storybook-foundation",
    "collection_merge_ready": true,
    "result": "Executed successfully. Updated `.storybook/preview.ts` to apply a shared consistency decorator frame without JSX syntax issues in `.ts`, updated `.storybook/main.ts` to enable Storybook autodocs and `@storybook/addon-a11y`, and documented preview conventions in `ui-style-contract.md` and `storybook-setup.md`. Validation commands passed: `npm --prefix apps/web run storybook -- --ci --smoke-test`, `npm --prefix apps/web run storybook:build`, and `rg -n \"storybook|decorator|preview|a11y\" apps/web/docs/contracts/ui-style-contract.md apps/web/docs/guides/storybook-setup.md`. Storybook emitted non-blocking warning about `/root/.storybook/settings.json` write permission and no-story-file warnings."
  },
  "task": {
    "objective": "Add shared Storybook preview settings that enforce consistent component rendering context.",
    "constraints": [
      "Preserve current UI style contract direction.",
      "Avoid introducing new design tokens without contract alignment.",
      "Keep decorators simple and reusable."
    ],
    "allowed_files": [
      {
        "path": "`apps/web/.storybook/preview.ts` (edit)",
        "access": "edit"
      },
      {
        "path": "`apps/web/.storybook/main.ts` (edit)",
        "access": "edit"
      },
      {
        "path": "`apps/web/docs/contracts/ui-style-contract.md` (edit)",
        "access": "edit"
      },
      {
        "path": "`apps/web/docs/guides/storybook-setup.md` (create/edit)",
        "access": "edit"
      }
    ],
    "steps": [
      {
        "id": "step_1",
        "instruction": "In `apps/web/.storybook/preview.ts`, add decorators for consistent page padding, neutral surface, and typography baseline.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_2",
        "instruction": "In `apps/web/.storybook/main.ts`, enable essential addons needed for docs and a11y checks.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_3",
        "instruction": "In `apps/web/docs/contracts/ui-style-contract.md`, document Storybook preview expectations for component consistency.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_4",
        "instruction": "In `apps/web/docs/guides/storybook-setup.md`, document how to run Storybook and expected preview conventions.",
        "files": [],
        "artifact": ""
      }
    ],
    "validation": {
      "commands": [
        "npm --prefix apps/web run storybook -- --ci --smoke-test",
        "npm --prefix apps/web run storybook:build",
        "rg -n \"storybook|decorator|preview|a11y\" apps/web/docs/contracts/ui-style-contract.md apps/web/docs/guides/storybook-setup.md"
      ]
    },
    "expected_output": [
      "Storybook stories render in a consistent baseline environment aligned with UI contract guidance."
    ],
    "stop_conditions": [
      "Stop and ask operator if preview conventions conflict with established UI style contract requirements."
    ],
    "notes": []
  }
}

{
  "kind": "directive_task",
  "schema_version": "1.0",
  "meta": {
    "id": "4b318b2a-1121-48a6-8140-47080961986c",
    "title": "Enforce no raw class-name literals in directives JSX",
    "status": "todo",
    "priority": "high",
    "session_priority": "high",
    "owner": "operator",
    "assignee": "executor",
    "bucket": "todo",
    "created": "2026-02-12T21:24:04.000Z",
    "updated": "2026-02-12T22:22:53.000Z",
    "tags": [
      "css",
      "directives",
      "lint",
      "enforcement"
    ],
    "effort": "medium",
    "depends_on": [
      "d68fbe6c-3176-4740-a4bf-80e1d3f0d051"
    ],
    "blocked_by": [],
    "related": [],
    "summary": "Add lint enforcement so directives TSX files cannot use raw class-name or utility-string literals.",
    "execution_model": "gpt-5.2-codex",
    "thinking_level": "medium",
    "result": {
      "summary": "Added directives-scoped ESLint rule to block raw className/class-composer literals and verified directives TSX remains compliant.",
      "validation": "pass-with-warnings: npm --prefix apps/web run lint\npass: npm --prefix apps/web run typecheck\npass: ! rg -n \"className\\s*=\\s*\\\"|className\\s*=\\s*'|className\\s*=\\s*\\{\\s*\\\"|className\\s*=\\s*\\{\\s*'\" apps/web/app/directives --glob '*.tsx'\nlint warnings (pre-existing in this task scope):\n- apps/web/app/directives/composites/TagsInput.tsx:126 react-hooks/exhaustive-deps (2 warnings)\n",
      "updated": "20260212T231907Z"
    }
  },
  "task": {
    "objective": "Add lint-level enforcement that blocks raw class-name and utility class string literals in directives JSX.",
    "constraints": [
      "Rule scope is `apps/web/app/directives/**/*.{ts,tsx}` only.",
      "Must reject string literal and template literal class assignment patterns.",
      "Must reject utility string literals passed into class composition helpers.",
      "Must allow style-token usage patterns (`styles.*`, `cn(styles.*)` and equivalent token composition)."
    ],
    "allowed_files": [
      {
        "path": "`apps/web/eslint.config.mjs`",
        "access": "edit"
      },
      {
        "path": "`apps/web/lib/eslint/no-raw-classname-literals-in-directives.mjs` (create)",
        "access": "edit"
      },
      {
        "path": "`apps/web/app/directives/**/*.tsx` (only minimal changes required to satisfy new lint rule)",
        "access": "edit"
      }
    ],
    "steps": [
      {
        "id": "step_1",
        "instruction": "Create `apps/web/lib/eslint/no-raw-classname-literals-in-directives.mjs` implementing a rule that rejects raw string/template literal class values in directives JSX.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_2",
        "instruction": "Extend the rule to reject string literal arguments passed to class composition utilities for directives files.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_3",
        "instruction": "Wire the rule in `apps/web/eslint.config.mjs` under a directives-scoped override.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_4",
        "instruction": "Run lint, remediate directives TSX violations using style-token references only, and confirm pass.",
        "files": [],
        "artifact": ""
      }
    ],
    "validation": {
      "commands": [
        "npm --prefix apps/web run lint",
        "npm --prefix apps/web run typecheck",
        "! rg -n \"className\\s*=\\s*\\\"|className\\s*=\\s*'|className\\s*=\\s*\\{\\s*\\\"|className\\s*=\\s*\\{\\s*'\" apps/web/app/directives --glob '*.tsx'"
      ]
    },
    "expected_output": [
      "Directives-scoped lint rule blocks raw class and utility string literal usage in JSX.",
      "Directives TSX passes lint with style-token-based class composition."
    ],
    "stop_conditions": [
      "Stop and request direction if parser/plugin limitations prevent deterministic detection without expanding allowed files."
    ],
    "notes": []
  }
}

{
  "kind": "directive_task",
  "schema_version": "1.0",
  "meta": {
    "id": "e0e363b9-be85-4996-be46-643d74affb68",
    "title": "Split global CSS into deterministic foundation layers",
    "status": "todo",
    "priority": "high",
    "session_priority": "high",
    "owner": "operator",
    "assignee": "executor",
    "bucket": "todo",
    "created": "2026-02-12T22:22:53.000Z",
    "updated": "2026-02-12T22:22:53.000Z",
    "tags": [
      "css",
      "globals",
      "tokens",
      "foundations"
    ],
    "effort": "medium",
    "depends_on": [],
    "blocked_by": [],
    "related": [],
    "summary": "Partition global CSS into dedicated styles layers with stable import order and no component-specific selectors.",
    "execution_model": "gpt-5.2-codex",
    "thinking_level": "medium",
    "result": {
      "summary": "Split globals into deterministic token/reset/base/utilities files and rewired imports through globals.css.",
      "validation": "pass: test -s apps/web/app/styles/tokens-primitives.css\npass: test -s apps/web/app/styles/tokens-semantic.css\npass: test -s apps/web/app/styles/typography-tokens.css\npass: test -s apps/web/app/styles/motion-tokens.css\npass: test -s apps/web/app/styles/breakpoint-tokens.css\npass: test -s apps/web/app/styles/reset.css\npass: test -s apps/web/app/styles/base.css\npass: test -s apps/web/app/styles/utilities.css\npass: rg -n \"@import\" apps/web/app/globals.css\npass: npm --prefix apps/web run typecheck\npass-with-warnings: npm --prefix apps/web run lint\nlint warnings (pre-existing in this task scope):\n- apps/web/app/directives/composites/TagsInput.tsx:124 react-hooks/exhaustive-deps (2 warnings)\nmanual visual checklist:\n- directives list page: not run (no browser-driven manual verification performed in this session)\n- directives session page: not run (no browser-driven manual verification performed in this session)\n",
      "updated": "20260212T223658Z"
    }
  },
  "task": {
    "objective": "Split `globals.css` into stable global style layers for tokens, reset, base, and minimal utilities while preserving runtime behavior.",
    "constraints": [
      "Keep `apps/web/app/globals.css` as the global entrypoint.",
      "Preserve visual behavior while splitting files.",
      "Do not place component-specific selectors into global layers.",
      "Manual visual checklist evidence is required in task result."
    ],
    "allowed_files": [
      {
        "path": "`apps/web/app/globals.css`",
        "access": "edit"
      },
      {
        "path": "`apps/web/app/styles/tokens-primitives.css` (create)",
        "access": "edit"
      },
      {
        "path": "`apps/web/app/styles/tokens-semantic.css` (create)",
        "access": "edit"
      },
      {
        "path": "`apps/web/app/styles/typography-tokens.css` (create)",
        "access": "edit"
      },
      {
        "path": "`apps/web/app/styles/motion-tokens.css` (create)",
        "access": "edit"
      },
      {
        "path": "`apps/web/app/styles/breakpoint-tokens.css` (create)",
        "access": "edit"
      },
      {
        "path": "`apps/web/app/styles/reset.css` (create)",
        "access": "edit"
      },
      {
        "path": "`apps/web/app/styles/base.css` (create)",
        "access": "edit"
      },
      {
        "path": "`apps/web/app/styles/utilities.css` (create)",
        "access": "edit"
      }
    ],
    "steps": [
      {
        "id": "step_1",
        "instruction": "Create `apps/web/app/styles/` and the layer files listed in Allowed files.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_2",
        "instruction": "Update `apps/web/app/globals.css` to import the layer files in deterministic order: tokens files first, then reset/base, then utilities.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_3",
        "instruction": "Move existing global declarations from `globals.css` into the appropriate layer files without changing behavior.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_4",
        "instruction": "Ensure selectors in global layers are limited to tokens, element/base selectors, and explicitly global utility selectors.",
        "files": [],
        "artifact": ""
      },
      {
        "id": "step_5",
        "instruction": "Record manual visual checklist evidence for directives list page and directives session page.",
        "files": [],
        "artifact": ""
      }
    ],
    "validation": {
      "commands": [
        "test -s apps/web/app/styles/tokens-primitives.css",
        "test -s apps/web/app/styles/tokens-semantic.css",
        "test -s apps/web/app/styles/typography-tokens.css",
        "test -s apps/web/app/styles/motion-tokens.css",
        "test -s apps/web/app/styles/breakpoint-tokens.css",
        "test -s apps/web/app/styles/reset.css",
        "test -s apps/web/app/styles/base.css",
        "test -s apps/web/app/styles/utilities.css",
        "rg -n \"@import\" apps/web/app/globals.css",
        "npm --prefix apps/web run typecheck",
        "npm --prefix apps/web run lint"
      ]
    },
    "expected_output": [
      "Global CSS is split into deterministic foundation files and loaded through `globals.css`.",
      "No component-specific selector logic is introduced into the global foundation layers."
    ],
    "stop_conditions": [
      "Stop and request direction if preserving current visuals requires component-specific selectors in global layers."
    ],
    "notes": []
  }
}
